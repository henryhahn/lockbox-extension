<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../img/favicon.ico">
  <title>Metrics Guide - Lockbox Extension</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">
  <link href="../css/extra.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Metrics Guide";
    var mkdocs_page_input_path = "metrics.md";
    var mkdocs_page_url = "/metrics/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Lockbox Extension</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <a class="" href="..">Introduction</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../install/">Installing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../user-guide/">User Guide</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../release-notes/">Release Notes</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../contributing/">Contributing</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../code_of_conduct/">Code of Conduct</a>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../api/">API Guide</a>
	    </li>
          
            <li class="toctree-l1 current">
		
    <a class="current" href="./">Metrics Guide</a>
    <ul class="subnav">
            
    <li class="toctree-l2"><a href="#lockbox-metrics-plan">Lockbox Metrics Plan</a></li>
    
        <ul>
        
            <li><a class="toctree-l3" href="#tldr-metrics-implemented-for-alpha-thus-far">TL;DR Metrics Implemented for Alpha Thus Far</a></li>
        
            <li><a class="toctree-l3" href="#analysis">Analysis</a></li>
        
            <li><a class="toctree-l3" href="#collection">Collection</a></li>
        
            <li><a class="toctree-l3" href="#metrics-overview">Metrics Overview</a></li>
        
            <li><a class="toctree-l3" href="#non-event-metrics">Non-Event Metrics</a></li>
        
            <li><a class="toctree-l3" href="#everything-below-here-is-old-and-out-of-date-not-implemented-kept-here-for-future-reference-only">!!!!!!! EVERYTHING BELOW HERE IS OLD AND OUT OF DATE NOT IMPLEMENTED KEPT HERE FOR FUTURE REFERENCE ONLY !!!!!!!</a></li>
        
            <li><a class="toctree-l3" href="#references">References</a></li>
        
        </ul>
    

    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <a class="" href="../releases/">Releases</a>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Lockbox Extension</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>Metrics Guide</li>
    <li class="wy-breadcrumbs-aside">
      
        <a href="https://github.com/mozilla-lockbox/lockbox-extension/edit/master/docs/metrics.md"
          class="icon icon-github"> Edit on GitHub</a>
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="lockbox-metrics-plan">Lockbox Metrics Plan</h1>
<p><em>Last Updated: October 9, 2017</em></p>
<!-- TOC depthFrom:2 depthTo:6 withLinks:1 updateOnSave:1 orderedList:0 -->

<ul>
<li><a href="#tldr-metrics-implemented-for-alpha-thus-far">TL;DR Metrics Implemented for Alpha Thus Far</a></li>
<li><a href="#analysis">Analysis</a></li>
<li><a href="#collection">Collection</a><ul>
<li><a href="#event-registration-and-recording">Event Registration and Recording</a></li>
</ul>
</li>
<li><a href="#metrics-overview">Metrics Overview</a></li>
<li><a href="#non-event-metrics">Non-Event Metrics</a></li>
<li><a href="#-everything-below-here-is-old-and-out-of-date-not-implemented-kept-here-for-future-reference-only-">!!!!!!! EVERYTHING BELOW HERE IS OLD AND OUT OF DATE NOT IMPLEMENTED KEPT HERE FOR FUTURE REFERENCE ONLY !!!!!!!</a><ul>
<li><a href="#setup-events">Setup Events</a></li>
<li><a href="#item-list-interaction-events">Item list Interaction Events</a></li>
<li><a href="#item-view-interaction-events">Item View Interaction Events</a></li>
<li><a href="#events-related-to-interactions-in-the-item-editors">Events Related to Interactions in the Item Editors</a></li>
<li><a href="#events-related-to-submitting-an-item-change-from-the-item-editors">Events Related to Submitting An Item Change from the Item Editors</a></li>
<li><a href="#events-related-to-changes-in-the-datastore">Events Related to Changes in the Datastore</a></li>
<li><a href="#feedback-events">Feedback Events</a></li>
<li><a href="#fill-events-tbd">Fill Events: TBD</a></li>
</ul>
</li>
<li><a href="#references">References</a></li>
</ul>
<!-- /TOC -->

<p><strong>Note to Lockbox Engineers:</strong> <em>The variable names used in this doc are just placeholders. Once I know what they will actually be I can update them.</em></p>
<p>This is the metrics collection plan for Lockbox's alpha release. It is more of a wishlist than a plan - only some portion of what's here might actually be implemented.</p>
<p>Best viewed in something that can render Markdown.</p>
<h2 id="tldr-metrics-implemented-for-alpha-thus-far">TL;DR Metrics Implemented for Alpha Thus Far</h2>
<p>These are the metrics that have been implemented in the pull request that included the edits to this doc.</p>
<p>All events are under the <strong>category: lockbox</strong>. The <code>extra</code> field always contains <code>fxaid</code> where possible (i.e. after FxA auth). In the future also the <code>itemid</code> where relevant.</p>
<ol>
<li>
<p><code>startup</code> fires when the webextension is loaded. <strong>method</strong>:click <strong>objects</strong>: addon, webextension.</p>
</li>
<li>
<p><code>iconClick</code> fires when someone clicks the toolbar icon. <strong>method</strong>:startup <strong>objects</strong>: toolbar.</p>
</li>
<li>
<p><code>render</code> fires when one of the views are rendered. <strong>method</strong>:render <strong>objects</strong>: firstrun, manage, popupUnlock</p>
</li>
<li>
<p><code>fxaSignIn</code> fires when someone clicks the signin button during firstrun. <strong>method</strong>: render <strong>objects</strong>: fxaSignInPage.</p>
</li>
<li>
<p><code>confirmPW</code> fires when the user clicks the button to confirm their FxA pw. <strong>method</strong>: click <strong>objects</strong>: confirmPWButton.</p>
</li>
<li>
<p><code>setupDone</code> fires after the user clicks the done button to close the wizard after fxa pw has been checked. <strong>method</strong>: click <strong>objects</strong>: setupDoneButton.</p>
</li>
<li>
<p><code>itemAdding</code> fires when a user submits a new item from the editor. <strong>method</strong>: itemAdding <strong>objects</strong>: addItemForm.</p>
</li>
<li>
<p><code>itemUpdating</code> fires when a user submits an edit to an existing item. <strong>method</strong>: itemUpdating <strong>objects</strong>: updatingItemForm.</p>
</li>
<li>
<p><code>itemDeleting</code> fires when user submits a request to delete an item. <strong>method</strong>: itemDeleting <strong>objects</strong>: updatingItemForm.</p>
</li>
<li>
<p><code>itemSelected</code> fires when a user clicks on an item in the item list. <strong>method</strong>: itemSelected <strong>objects</strong>: itemList.</p>
</li>
<li>
<p><code>addClick</code> fires when a user clicks the add new item button from the item list . <strong>method</strong>: addClick <strong>objects</strong>: addButton.</p>
</li>
<li>
<p><code>itemAdded</code> fires when the <code>addItemCompleted</code> function is called on the front end. Has itemid added as extra. <strong>method</strong>: itemAdded <strong>objects</strong>: addItemForm.</p>
</li>
<li>
<p><code>datatore</code> fires when an item is added/updated/deleted from the backend.  Has itemid (and sometimes fields) added as extra. <strong>methods</strong>:added, updated, deleted <strong>objects</strong>: datastore.</p>
</li>
<li>
<p><code>feedback</code> fires when the user clicks the "Send Feedback" button. <strong>methods</strong>:feedbackClick <strong>objects</strong>:manage</p>
</li>
</ol>
<h2 id="analysis">Analysis</h2>
<p>We will aim to collect data that will help us understand the following (please add anything that you think is important, these are just the basics; note that not all these things will be answerable give the data we will have to work with during alpha):</p>
<ul>
<li>Do people Save Passwords in Lockbox?<ul>
<li>How many? (count of items saved per user)</li>
<li>How often? (number of credentials saved per time interval)</li>
</ul>
</li>
<li>Do people create their own passwords or use Lockbox to generate them?<ul>
<li>Ratio: (Number of times the PW generator is used when storing an item) / (number of credentials stored)</li>
</ul>
</li>
<li>Do people use the passwords they store on Lockbox?<ul>
<li>How many times (per some unit of time) do stored credentials get auto-filled?</li>
<li>How many times do they copy a credential (e.g. to fill it in manually)</li>
<li>How many times do they reveal a credential in the CRUD editor?</li>
</ul>
</li>
<li>How well does does auto-filling credentials work <strong>(not in alpha)</strong>?<ul>
<li>When credentials are auto-filled, are they filled into the correct fields?</li>
<li>How often must the user make a change to what fields were filled?<ul>
<li>How to measure these things??? is there an easier way than just asking if the auto-fill didn't work?</li>
</ul>
</li>
</ul>
</li>
<li>Do people continue to use Lockbox after first use?<ul>
<li>Out of those who install, how many use it more than once?</li>
</ul>
</li>
<li>Where are the drop-off points in the user flow?<ul>
<li>Do the majority of people make it all the way through the setup process?</li>
<li>Once initially setup, do people continue to add credentials?</li>
<li>Do people continue to auto-fill credentials after the first usage?</li>
</ul>
</li>
<li>What are people's opinions on LB<ul>
<li>Feedback forms</li>
</ul>
</li>
<li>Do people sync their passwords <strong>(not in alpha)</strong>?<ul>
<li>How does syncing affect engagement?</li>
</ul>
</li>
<li>Maybe: what type of sites do people use Lockbox with <strong>(not in alpha)</strong>?</li>
</ul>
<h2 id="collection">Collection</h2>
<p><strong>Note:</strong> <em>This is the collection plan for our internal alpha release. For our beta release will be taking advantage of test pilot's telemetry API. The metrics plan for beta will be described in a separate document.</em></p>
<p>At this point, all measurements related to Lockbox will be made client-side. All users will have to authenticate through FxA, and thus additional measurements related to that will be logged on the FxA auth server. We have no control over what is already collected via that mechanism.</p>
<p>For our internal alpha release, we will be making use of the public JavaScript API that allows recording and sending of event data through an add-on. <strong>This means that for our alpha release we will only be collecting event-based data</strong>. The API is documented here:</p>
<p>https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/events.html#the-api</p>
<p>Once the events are logged in the client they should appear in <a href="about:telemetry">about:telemetry</a>. From there they will be submitted in the main ping payload under <code>processes.dynamic.events</code> and available through the usual services (STMO and ATMO), as well as amplitude.</p>
<h3 id="event-registration-and-recording">Event Registration and Recording</h3>
<p>The events that we will record will conform to the structure expected by the telemetry pipeline. When the events are logged in telemetry they will be a list of:</p>
<p><code>[timestamp, category, method, object, value, extra]</code></p>
<p>The API takes care of the timestamp for us. We just need to define <code>category</code>, <code>method</code>, <code>object</code> and <code>extra</code> (<code>value</code> is optional and we won't use it).</p>
<p>Because we are using the API through an add-on it <strong>isn't</strong> necessary that we include an events.yaml file.</p>
<p>Instead we will define our events by <strong>registering</strong> them using a call to <code>Services.telemetry.registerEvents(category, eventData)</code>.</p>
<p>Here's a breakdown of how a to register a typical event:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;event_category&quot;, {
    &quot;event_name&quot;: {
        methods: [&quot;click&quot;, ... ], // types of events that can occur
        objects: [&quot;a_button&quot;, ... ], // objects event can occur on
        extra: {&quot;key&quot;: &quot;value&quot;, ... } // key-value pairs (strings)
    }
</code></pre>

<p>For our purposes, we will use the <code>extra</code> field for a few purposes:</p>
<ul>
<li>To log the FxA user id of the client logging the event (e.g. <code>"fxauid": uid</code>)</li>
<li>To log the UUID of the item that has been added or changed (e.g. <code>"item_id": UUID</code>)</li>
<li>To log the fields that are modified when an item is updated in the datastore (e.g. <code>"fields": "password,notes"</code>  (because the value has to be a string we will have to concat the fields that were updated somehow)</li>
</ul>
<p>Once an event is registered, we can record it with:</p>
<p><code>Services.telemetry.recordEvent(category, method, object, null, extra)</code></p>
<p>When recording, we can use <code>null</code> for <code>value</code>.</p>
<p>See the Events section for specific examples of event registration and recording.</p>
<h2 id="metrics-overview">Metrics Overview</h2>
<p>For alpha, we'd like to (ideally) like to be able to track the following general categories of things:</p>
<ul>
<li>The setup flow, so we can know at what points (if any) people quit the flow before finishing it</li>
<li>Top-level interactions centered around use of the Lockbox toolbar icon. This includes interactions within the initial pop-over that is displayed when the user clicks the icon.</li>
<li>Interactions with the main CRUD editor view which lists the user's Lockbox items (credentials)</li>
<li>Interactions with the add / modify dialogs used to enter / edit item information</li>
<li>Changes to the datastore that actually contains the user's items, in addition to user actions that lead to those changes</li>
<li>When the user submits feedback about lockbox</li>
</ul>
<p>Each of these are described below within their own Events subsection.</p>
<h2 id="non-event-metrics">Non-Event Metrics</h2>
<p>These are the metrics we plan to collect regarding the state of user datastores. Note that we won't be able to record these directly for alpha. We will have to infer them from the event data.</p>
<ul>
<li>
<p><code>n_items</code> The number of credentials that exist in the user's datastore. Integer</p>
</li>
<li>
<p><code>n_notes</code> The number of items for which the user has manually entered custom notes for. Integer</p>
</li>
<li><code>timestamp_last</code> The timestamp of the last edit the user made to the datastore. Does not necessarily correspond to the last time they opened the CRUD editor.</li>
</ul>
<h2 id="everything-below-here-is-old-and-out-of-date-not-implemented-kept-here-for-future-reference-only">!!!!!!! EVERYTHING BELOW HERE IS OLD AND OUT OF DATE NOT IMPLEMENTED KEPT HERE FOR FUTURE REFERENCE ONLY !!!!!!!</h2>
<h3 id="setup-events">Setup Events</h3>
<p>From a metrics point of view, the FxA sign-in / account creation process is a black box to us. Thus the best we can do at this point is track when a user interacts with the Lockbox-specific views that are included in the first run flow.</p>
<p>We have two <strong>categories</strong> of events here: rendering events and interaction events:  <code>lockbox_setup.render</code> and <code>lockbox_setup.interaction</code>. For rendering events, the <strong>object</strong> field is populated by the name of the view being rendered; for interaction events the <strong>object</strong> is the name of the button. Below is a brief description of the view names and their corresponding buttons.</p>
<ul>
<li><code>lockbox_toolbar_firstrun</code><ul>
<li>Pop-over shown when the user first clicks on the Lockbox toolbar icon after install. Contains the <code>get_started_button</code>. Note that the click on the toolbar icon itself is logged in a separate event (see "Toolbar Button Interaction Event" section below).</li>
</ul>
</li>
<li><code>reenter_password</code><ul>
<li>Shown after FxA process is completed. Prompts user to re-enter their FxA pw to start using lockbox. Contains the <code>lockbox_signin_button</code></li>
</ul>
</li>
</ul>
<p>The <strong>methods</strong> for these events are <code>render</code> and <code>click</code> for rendering and interaction events, respectively.</p>
<p>The <strong>extra</strong> field contains the user's FxA anonymous/random user id. For <code>lockbox_toolbar_firstrun</code> view this will be <code>null</code>.</p>
<p>To register the rendering events:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_setup.render&quot;, {
  &quot;lockbox_setup.render&quot;: {
    methods: [&quot;render&quot;],
    objects: [&quot;lockbox_toolbar_firstrun&quot;, // startup flow views
            &quot;reenter_password&quot;],
    extra: {&quot;fxauid&quot;: uid} // value is null in some cases, see above
  }
});
</code></pre>

<p>To register the interaction events:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_setup.interaction&quot;, {
  &quot;lockbox_setup.click&quot;: {
    methods: [&quot;click&quot;],
    objects: [&quot;get_started_button&quot;, // start-up flow buttons
              &quot;lockbox_signin_button&quot;],
    extra: {&quot;fxauid&quot;: uid} // value is null in some cases, see above
  }
});
</code></pre>

<p>An example of how to record a rendering of the <code>reenter_password</code> view:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_setup.render&quot;,
                    &quot;render&quot;,
                    &quot;reenter_password&quot;,
                    null,
                    {&quot;fxauid&quot;: uid} ) // user has signed in by now);
</code></pre>

<p>To record (for example) a click on one of the <code>lockboxSignin_button</code> button:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_setup.interaction&quot;,
                    &quot;click&quot;,
                    &quot;lockbox_signin_button&quot;,
                    null,
                    {&quot;fxauid&quot;: null} ) // user hasn't signed in yet);
</code></pre>

<h3 id="item-list-interaction-events">Item list Interaction Events</h3>
<p>These events relate to interactions with the item list rendered after a click of the Lockbox toolbar button. These events assume that the user has already logged in with FxA. For events related to the setup flow, see the section above.</p>
<p>Immediately after setup there will be no items in the datastore. As long as this is the case, the item list will be empty and the user will have to click the <code>add_new_button</code> to add their first entry. As long as there is at least one entry in the datastore, the item list will be displayed in the left pane.</p>
<p>We will have two categories of events related to the item list: <code>lockbox_item_list.render</code> and <code>lockbox_item_list.interaction</code>. They will be recorded as <code>lockbox_item_list.render</code> and <code>lockbox_item_list.click</code>.</p>
<p>For the rendering events, there are two possible objects, <code>item_list_empty</code> and <code>item_list_populated</code> corresponding to a rendering of an empty item list and an item list with at least one entry, respectively.</p>
<p>The possible <strong>methods</strong> are <code>click</code> and <code>render</code>.</p>
<p>The <strong>objects</strong> are <code>item_button</code> (the clickable area of an entry in the item list), <code>feedback_button</code>, <code>add_new_button</code> (available so long as there at least one item in the datastore), and <code>search_box</code>.</p>
<p>To register the interaction events:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_item_list.interaction&quot;, {
  &quot;lockbox_item_list.click&quot;: {
    methods: [&quot;click&quot;],
    objects: [&quot;item_button&quot;,
        &quot;feedback_button&quot;,
        &quot;add_new_button&quot;,
        &quot;search_box&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>To register the render events:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_item_list.render&quot;, {
  &quot;lockbox_item_list.render&quot;: {
    methods: [&quot;render&quot;],
    objects: [&quot;item_list_empty&quot;,
        &quot;item_list_populated&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>To record (for example) a click on the add new entry button:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_item_list.interaction&quot;,
                    &quot;click&quot;,
                    &quot;add_new_button&quot;,
                    null,
                    {&quot;fxauid&quot;: uid});
</code></pre>

<h3 id="item-view-interaction-events">Item View Interaction Events</h3>
<p>When a user clicks on an item from the item list, they will be directed to the item view. We will log clicks on each of the five buttons in this view (also the <strong>objects</strong> used in the event): <code>edit_entry_button</code>, <code>delete_entry_button</code>, <code>show_password_button</code>, <code>copy_password_button</code>, and <code>copy_username_button</code>.</p>
<p>The event <strong>category</strong> is <code>item_view.interaction</code> and the event is recorded as <code>item_view.click</code>.</p>
<p>The <strong>method</strong> is <code>click</code>.</p>
<p>Example event registration:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_item_view.interaction&quot;, {
  &quot;lockbox_item_view.click&quot;: {
    methods: [&quot;click&quot;],
    objects: [&quot;edit_entry_button&quot;,
        &quot;delete_entry_button&quot;,
        &quot;show_password_button&quot;,
        &quot;copy_password_button&quot;,
        &quot;copy_username_button&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>Example of recording a click to show password event:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_item_view.interaction&quot;,
                    &quot;click&quot;,
                    &quot;show_password_button&quot;,
                    null,
                    {&quot;fxauid&quot;: uid});
</code></pre>

<h3 id="events-related-to-interactions-in-the-item-editors">Events Related to Interactions in the Item Editors</h3>
<p>These events record actions users take in the item editors. There are separate views for editing existing items and for adding new entries, though the fields that exist in each are similar. Thus we have four <strong>categories</strong> of events: <code>lockbox_new_item.interaction</code>, <code>lockbox_edit_item.interaction</code> and the rendering events <code>lockbox_new_item.render</code> and <code>lockbox_edit_item.render</code>.</p>
<p>For events related to the submission of actual item information, see the next section. The item editors have 5 fields: <code>title_field</code>, <code>origin_field</code> (URL for the credential), <code>username_field</code>, <code>password_field</code>, and <code>notes_field</code>. There are also three buttons: <code>save_entry_button</code>, <code>cancel_button</code>, and <code>toggle_password_button</code>. The latter toggles the visibility of characters in the password field.  </p>
<p>The <strong>methods</strong> are <code>click</code> and <code>render</code>.</p>
<p>Example event registration (Substitute <code>lockbox_new_item</code> with <code>lockbox_edit_item</code> to register events for the existing item editor):</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_new_item.interaction&quot;, {
  &quot;lockbox_item_editor.click&quot;: {
    methods: [&quot;click&quot;],
    objects: [&quot;title_field&quot;,
        &quot;origin_field&quot;,
        &quot;username_field&quot;,
        &quot;password_field&quot;,
        &quot;notes_field&quot;,
        &quot;save_entry_button&quot;,
        &quot;cancel_button&quot;,
        &quot;toggle_password_button&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>For the rendering events:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_new_item.render&quot;, {
  &quot;lockbox_item_editor.render&quot;: {
    methods: [&quot;render&quot;],
    objects: [&quot;lockbox_new_item_view&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>Example of recording a click on the <code>save_entry_button</code>:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_item_editor.interaction&quot;,
                    &quot;click&quot;,
                    &quot;save_entry_button&quot;,
                    null,
                    {&quot;fxauid&quot;: uid});
</code></pre>

<h3 id="events-related-to-submitting-an-item-change-from-the-item-editors">Events Related to Submitting An Item Change from the Item Editors</h3>
<p>Events of <strong>category</strong> <code>lockbox_item_change_submitted</code> record the actual submission of new item information to the datastore (either completely new entries or updates to existing items).</p>
<p>In theory, these should be tied to equivalent events in the datastore, so that (for example) an <code>adding</code> event which is logged when a user submits a new item has a corresponding <code>added</code> event that gets logged when the item is successfully added to the datastore. This may need to change, but for simplicity's sake I've made it as close to the datastore events as possible (see next section). These events will be recorded as <code>lockbox_item_change_submitted</code>.</p>
<p><strong>Methods</strong> for this event are <code>adding</code>, <code>updating</code> and <code>deleting</code>.</p>
<p>The <strong>object</strong> can be <code>new_item</code> or <code>edit_item</code>.</p>
<p>The <strong>extra</strong> field contains the item's UUID <em>for updating and deleting events only</em>. For adding events, it always contains the string "new".</p>
<p>To register these events, we would do something like:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_item_change_submitted&quot;, {
  &quot;lockbox_item_change_submitted&quot;: {
    methods: [&quot;adding&quot;,&quot;updating&quot;,&quot;deleting&quot;],
    objects: [&quot;new_item&quot;,&quot;edit_item&quot;],
    extra: {&quot;fxauid&quot;: uid,
            &quot;item_id&quot;: UUID}
  }
});
</code></pre>

<p>To record a new item submission (note the <code>item_id</code> is "new"):</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_item_change_submitted&quot;,
                    &quot;added&quot;,
                    &quot;new_item&quot;,
                    null,
                    {&quot;fxauid&quot;: uid,
                    &quot;item_id&quot;: &quot;new&quot;});
</code></pre>

<h3 id="events-related-to-changes-in-the-datastore">Events Related to Changes in the Datastore</h3>
<p>We will record an event of <strong>category</strong> <code>lockbox_datastore.changed</code> when there is a change to the datastore. These events will be recorded as <code>lockbox_entry_changed</code>.</p>
<p><strong>Methods</strong> for this event are <code>added</code>, <code>updated</code> and <code>deleted</code>.</p>
<p>The <strong>object</strong> field is always <code>datastore</code>.</p>
<p>The <strong>extra</strong> field contains the item's (hashed) UUID. This will allow us to track changes to an item over its lifetime. When the method is <code>updated</code>, this field also includes a list indicating which fields in the credential were updated.</p>
<p>To register these events, we would do something like:</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_datastore.changed&quot;, {
  &quot;lockbox_entry_changed&quot;: {
    methods: [&quot;added&quot;,&quot;updated&quot;,&quot;deleted&quot;],
    objects: [&quot;datastore&quot;],
    extra: { &quot;fxauid&quot;: uid,
    &quot;item_id&quot;: UUID,
    &quot;fields&quot;: &quot;title,origins,login.password,login.notes&quot; }  }
});
</code></pre>

<p>An example of logging an item update in the datastore:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_database.changed&quot;,
                    &quot;updated&quot;,
                    &quot;datastore&quot;,
                    null,
                    {&quot;fxauid&quot;: uid,
                    &quot;item_id&quot;: UUID,
                    &quot;fields&quot;: &quot;username,password&quot;});
</code></pre>

<h3 id="feedback-events">Feedback Events</h3>
<p>When the user enters the feedback form through the button on the item list, we will record an event when a user submits feedback. Note that this will <em>not</em> contain the feedback itself: that is logged elsewhere (not thru telemetry).</p>
<pre><code class="javascript">Services.telemetry.registerEvents(&quot;lockbox_feedback.interaction&quot;, {
  &quot;lockbox_feedback_submit.click&quot;: {
    methods: [&quot;click&quot;],
    objects: [&quot;submit_button&quot;],
    extra: {&quot;fxauid&quot;: uid}
  }
});
</code></pre>

<p>To record (for example) a click of the toolbar:</p>
<pre><code class="javascript">Services.telemetry.recordEvent(&quot;lockbox_feedback.interaction&quot;,
                    &quot;click&quot;,
                    &quot;submit_button&quot;,
                    null,
                    {&quot;fxauid&quot;: uid});
</code></pre>

<h3 id="fill-events-tbd">Fill Events: TBD</h3>
<p>This section will describe the events related to auto-filling login credentials on web forms using items from the datastore. Since this isn't invented yet, its empty.</p>
<hr />
<h2 id="references">References</h2>
<p>Docs for the Public JS API that allows us to log events thru an add-on:</p>
<p>https://firefox-source-docs.mozilla.org/toolkit/components/telemetry/telemetry/collection/events.html#the-api</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../releases/" class="btn btn-neutral float-right" title="Releases">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../api/" class="btn btn-neutral" title="API Guide"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/mozilla-lockbox/lockbox-extension/" class="fa fa-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../api/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../releases/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme.js"></script>
      <script src="../search/require.js"></script>
      <script src="../search/search.js"></script>

</body>
</html>
